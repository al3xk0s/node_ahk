"use strict";var Le=Object.create;var k=Object.defineProperty;var Ue=Object.getOwnPropertyDescriptor;var _e=Object.getOwnPropertyNames;var He=Object.getPrototypeOf,Re=Object.prototype.hasOwnProperty;var Ne=(e,t)=>{for(var o in t)k(e,o,{get:t[o],enumerable:!0})},ie=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of _e(t))!Re.call(e,n)&&n!==o&&k(e,n,{get:()=>t[n],enumerable:!(r=Ue(t,n))||r.enumerable});return e};var ae=(e,t,o)=>(o=e!=null?Le(He(e)):{},ie(t||!e||!e.__esModule?k(o,"default",{value:e,enumerable:!0}):o,e)),$e=e=>ie(k({},"__esModule",{value:!0}),e);var je={};Ne(je,{BoolState:()=>b,BoolStateCompose:()=>de,Cast:()=>ce,Cursor:()=>we,DisposeWrapper:()=>D,DocUtils:()=>d,EasingFunctions:()=>Q,Key:()=>Se,KeysSequence:()=>De,MouseKey:()=>ve,Observable:()=>v,PromiseUtils:()=>S,Queue:()=>A,Rx:()=>_,ScrollDirection:()=>$,ScrollKey:()=>Me,StringUtils:()=>B,SuchKey:()=>R,SuchMouseKey:()=>N,combineDisposers:()=>Z,combineListeners:()=>I,combineScriptsWithDoc:()=>fe,createTimer:()=>pe,createTimerSequence:()=>le,force:()=>W,getHoldKey:()=>Ee,getTapKey:()=>Oe,getTickByHold:()=>Ce,getTickKey:()=>We,holdKey:()=>re,inOfAny:()=>x,runScript:()=>he,runScripts:()=>ee,sleep:()=>g.sleep,stream:()=>P,tapKey:()=>ne,tickKey:()=>se,toDisposer:()=>C,toListener:()=>h,toggleStateByTap:()=>V,whileNeed:()=>Ae,whileNeedAsync:()=>Be,wrapToScriptWithDoc:()=>T});module.exports=$e(je);var ce=(e,t,o)=>({match:t,typeName:o,cast:()=>{if(!t(e))throw new Error(`Value ${e} is not type ${o}`);return e},tryCast:()=>{if(t(e))return e}});var W=e=>{if(e==null)throw new Error("Value is not exist");return e},x=(e,t)=>{try{return e in t}catch{return!1}};var P=e=>{let t=typeof e!="function"?()=>e:e;return{forEach(o){let r=0;for(let n of t())o(n,r),r++;return this},map:o=>P(function*(){let n=0;for(let s of t())yield o(s,n),n++}),filter:o=>P(function*(){let n=0;for(let s of t())o(s,n)&&(yield s),n++}),get count(){let o=0;for(let r of t())o++;return o},toArray:()=>{let o=[];for(let r of t())o.push(r);return o},get first(){return W(this.firstOrNull)},get last(){return W(this.lastOrNull)},get firstOrNull(){for(let o of t())return o},get lastOrNull(){let o;for(let r of t())o=r;return o}}};var A=class e{static from(t){let o=new e;for(let r of t)o.push(r);return o}pop(){if(this.isEmpty)return;let t=this._head;return this._head=t?.next,this._head==null&&(this._tail=void 0),t?.value}*popAll(){let t;for(;;){if(t=this.pop(),t==null)return;yield t}}push(t){let o={value:t};if(this.isEmpty){this._tail=o,this._head=this._tail;return}this._tail.next=o,this._tail=o}get isEmpty(){return this._head==null||this._tail==null}get canPop(){return!this.isEmpty}get length(){return this.isEmpty?0:P(this.toArray()).count}*toArray(){let t=this._head;for(;t!=null;)yield t.value,t=t.next}stream(){return P(this.toArray())}};var B=class{constructor(){}static{this.toTitleCase=t=>t.split(" ").filter(o=>o!=null&&o!=="").map(o=>o.substring(0,1).toUpperCase()+o.substring(1)).join(" ")}};var S=class{constructor(){}static{this.delayed=(t,o)=>new Promise(r=>{setTimeout(()=>o!=null?r(o()):r(void 0),t)})}static{this.microtask=t=>this.delayed(0,t)}};var pe=({durationMs:e,onStart:t,onStop:o})=>{let r,n,s,i=()=>{r!=null&&(clearTimeout(r),r=null,s=void 0,n?.())};return{start:()=>(i(),t?.(),s=new Promise(a=>{n=a}).then(()=>o?.()),r=setTimeout(()=>{i()},e),s),stop:i}},le=({onStart:e,onStop:t},...o)=>{let r,n=!0,s=()=>{n||(r?.stop(),n=!0)},i=async()=>{s(),n=!1,e?.();for(let a of o){if(n)break;r=a,await r.start()}s()};return{start:async()=>{await i(),t?.()},stop:s}};var ue=ae(require("crypto")),U=new Uint8Array(256),L=U.length;function G(){return L>U.length-16&&(ue.default.randomFillSync(U),L=0),U.slice(L,L+=16)}var m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));function ye(e,t=0){return m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]}var me=ae(require("crypto")),z={randomUUID:me.default.randomUUID};function Fe(e,t,o){if(z.randomUUID&&!t&&!e)return z.randomUUID();e=e||{};let r=e.random||(e.rng||G)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){o=o||0;for(let n=0;n<16;++n)t[o+n]=r[n];return t}return ye(r)}var J=Fe;var v=()=>{let e=new Map;return{listen:t=>{let o=J();return e.set(o,t),()=>e.delete(o)},notify:t=>{for(let o of e.values())o(t)},dispose:()=>e.clear()}},D=()=>{let e=[],t=o=>e.push(o);return{addDisposer:t,addDisposers:o=>o.forEach(t),dispose:()=>e=[]}};var _=(e,{comparer:t=(r,n)=>r===n,forceUpdate:o=!1}={})=>{let r=e,n=v();return{get value(){return r},setValue:(s,{forceUpdate:i=o}={})=>{let c=r;if(r=s,i||!t(c,s))return n.notify(r)},listen:n.listen,dispose:n.dispose}};var b=(e=!1,t={})=>{let o=_(e,t),r=()=>o.setValue(!o.value),n=()=>o.setValue(!0),s=()=>o.setValue(!1);return{get value(){return o.value},get isEnabled(){return o.value},setValue:o.setValue,dispose:o.dispose,listen:o.listen,toggle:r,enable:n,disable:s}},de={onlyOneActive:(...e)=>{let t=D();for(let o=0;o<e.length;o++){let r=e[o],n=[];for(let s=0;s<e.length;s++)o!=s&&n.push(e[s]);t.addDisposer(r.listen(s=>s&&n.forEach(i=>i.disable())))}return t}};var d=(()=>{let e=p=>`activate ${p.toString()}`,t=p=>`tap ${p.toString()}`,o=p=>`hold ${p.toString()}`,r=p=>`tick ${p.toString()}`,n=({when:p,then:u})=>`When ${e(p)}, then ${o(u)}`,s=({when:p,then:u})=>`When ${t(p)}, then ${t(u)}`,i=({when:p,then:u})=>`When ${e(p)}, then ${r(u)}`,c=p=>x("doc",p),a=p=>{if(typeof p=="string")return[p];if(Array.isArray(p))return p.map(u=>a(u)).reduce((u,w)=>[...u,...w]);if(c(p))return a(p.doc);throw Error(`Value ${p} int't doc`)},l=p=>a(p).map(u=>u).join(`
`);return{holdKey:n,tapKey:s,tickKey:i,toStringArray:a,join:l,print:p=>console.log(l(p)),activate:e,tap:t,tick:r,hold:o,isWithDoc:c}})();var H=require("suchibot"),R=(()=>{let e={...H.Key};return delete e.PAGE_UP,delete e.NUM_LOCK,e})(),N=H.MouseButton;var C=e=>typeof e=="function"?()=>void e():x("stop",e)?()=>e.stop():()=>{},h=e=>({stop:C(e)}),Z=e=>{let t=D();return t.addDisposers(e),C(t.dispose)},I=e=>h(Z(e.map(C)));var g=require("suchibot");var T=(e,{getDoc:t})=>(...o)=>Object.assign(()=>e(...o),{doc:t(...o)}),fe=e=>Object.assign(()=>I(e.map(o=>h(o()))),{doc:d.toStringArray(e)}),ee=e=>{e.forEach(t=>t()),e.forEach(t=>d.print(t))},he=e=>ee([e]);var M=e=>{let t=b(!1),o=()=>t.isEnabled,r=async a=>{for(;o();)e(),await(0,g.sleep)(a)},n=()=>t.disable();return{tick:({delayMs:a=50}={})=>{o()&&n(),t.enable(),r(a)},onTickStart:a=>{let l=t.listen(f=>{f&&a()});return h(l)},onTickRelease:a=>{let l=t.listen(f=>{f||a()});return h(l)},releaseTick:n,isTicked:o}};var y=require("suchibot");var te=({onDown:e,onUp:t,hold:o,release:r})=>({onToggleEnabled:(n,{initialEnabled:s=!1,onDisable:i}={})=>{let c=b(s);return e(a=>(c.toggle(),c.isEnabled?n(c,a):i?.(c,a)))},onHold:(n,{onDisable:s}={})=>{let i=b(!1);return I([e(c=>{i.isEnabled||(i.enable(),n(i,c))}),t(c=>{i.disable(),s?.(i,c)})])},holdOnTime:async n=>{o(),await S.delayed(n),r()}}),Ke=e=>{let t=()=>y.Keyboard.tap(e),o=i=>y.Keyboard.onDown(e,c=>i(c.modifierKeys)),r=i=>y.Keyboard.onUp(e,c=>i(c.modifierKeys)),n=()=>y.Keyboard.hold(e),s=()=>y.Keyboard.release(e);return{isDown:()=>y.Keyboard.isDown(e),isUp:()=>y.Keyboard.isUp(e),onDown:o,onUp:r,tap:t,hold:n,release:s,get value(){return e},...M(t),...te({hold:n,release:s,onDown:o,onUp:r}),type:"keyboard",toString:()=>`${e}`}},be=e=>{let t=()=>y.Mouse.click(e),o=i=>y.Mouse.onDown(e,c=>i(c.modifierKeys)),r=i=>y.Mouse.onUp(e,c=>i(c.modifierKeys)),n=()=>y.Mouse.hold(e),s=()=>y.Mouse.release(e);return{isDown:()=>y.Mouse.isDown(e),isUp:()=>y.Mouse.isUp(e),onDown:o,onUp:r,tap:t,hold:n,release:s,get value(){return e},onClick:i=>y.Mouse.onClick(e,i),doubleClick:()=>y.Mouse.doubleClick(e),...M(t),...te({hold:n,release:s,onDown:o,onUp:r}),type:"mouse",toString:()=>`${e} (mouse)`}},Qe={alt:!1,control:!1,shift:!1,super:!1,windows:!1,command:!1,meta:!1,leftAlt:!1,leftControl:!1,leftShift:!1,leftSuper:!1,leftWindows:!1,leftCommand:!1,leftMeta:!1,rightAlt:!1,rightControl:!1,rightShift:!1,rightSuper:!1,rightWindows:!1,rightCommand:!1,rightMeta:!1},Te=e=>{if(e.length<=0)throw new Error("Empty key sequence");let t=()=>e.forEach(a=>a.tap()),o=()=>e.forEach(a=>a.hold()),r=()=>e.forEach(a=>a.release()),n=(a,l,f)=>{let p=e[0],u=e.slice(1);return u.length==0?l(p)(a):l(p)(()=>{u.every(f)&&a(Qe)})},s=a=>n(a,l=>l.onDown,l=>l.isDown()),i=a=>n(a,l=>l.onUp,l=>l.isUp()),c=()=>e.map(a=>a.value).join(" + ");return{isDown:()=>e.every(a=>a.isDown()),isUp:()=>e.every(a=>a.isUp()),onDown:s,onUp:i,tap:t,hold:o,release:r,get value(){return c()},...M(t),...te({hold:o,release:r,onDown:s,onUp:i}),type:"keyboard",toString:()=>`${c()}`}};var Ie=require("suchibot");var $=(o=>(o[o.up=1]="up",o[o.down=-1]="down",o))($||{}),oe=100,Pe=({step:e=oe,direction:t})=>{let o=v(),r=()=>{Ie.Mouse.scroll({y:e*t}),o.notify()};return{step:e,direction:t,tap:r,...M(r),toString:()=>`${$[t]} (scroll)`}},ge=(e=oe)=>Pe({step:e,direction:-1}),xe=(e=oe)=>Pe({step:e,direction:1});var Se=(()=>{let e={};return Object.entries(R).forEach(([t,o])=>e[t]=Ke(o)),e})(),ve=(()=>{let e={};return Object.entries(N).forEach(([t,o])=>e[t]=be(o)),e})(),De=Te,Me={UP:xe,DOWN:ge};var K=require("suchibot");var F=e=>e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375,Ve=e=>1-F(1-e),qe=e=>e<.5?(1-F(1-2*e))/2:(1+F(2*e-1))/2,Q={easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInExpo:e=>e===0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e===1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e===0?0:e===1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>2.70158*e*e*e-1.70158*e*e,easeOutBack:e=>1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2),easeInOutBack:e=>{let o=2.5949095;return e<.5?Math.pow(2*e,2)*((o+1)*2*e-o)/2:(Math.pow(2*e-2,2)*((o+1)*(e*2-2)+o)+2)/2},easeInElastic:e=>{let t=2*Math.PI/3;return e===0?0:e===1?1:-Math.pow(2,10*e-10)*Math.sin((e*10-10.75)*t)},easeOutElastic:e=>{let t=2*Math.PI/3;return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e*10-.75)*t)+1},easeInOutElastic:e=>{let t=2*Math.PI/4.5;return e===0?0:e===1?1:e<.5?-(Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*t))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*t)/2+1},easeOutBounce:F,easeInBounce:Ve,easeInOutBounce:qe,linear:e=>e};var we=(()=>{let e=()=>K.Mouse.getPosition(),t=({x:s,y:i})=>{if(s!=null&&i!=null)return K.Mouse.moveTo(s,i);let c=e();return K.Mouse.moveTo(s??c.x,i??c.y)};return{move:({x:s,y:i})=>{let c=e();return t({x:c.x+(s??0),y:c.y+(i??0)})},moveTo:t,moveToEase:({position:s,durationMs:i,easing:c=Q.linear})=>new Promise(async a=>{let l=e(),f={x:s.x??l.x,y:s.y??l.y},p=f.x-l.x,u=f.y-l.y,w=Date.now(),q=1;for(;;){let j=Date.now()-w,E=Math.min(1,j/i),O=c(E),X=l.x+p*O,Y=l.y+u*O;if(K.Mouse.moveTo(X,Y),E===1)break;await(0,K.sleep)(q)}a()}),moveEase:({offset:s,durationMs:i,easing:c=Q.linear})=>new Promise(async a=>{let l=e(),f={x:l.x+(s.x??0),y:l.y+(s.y??0)},p=f.x-l.x,u=f.y-l.y,w=Date.now(),q=1;for(;;){let j=Date.now()-w,E=Math.min(1,j/i),O=c(E),X=l.x+p*O,Y=l.y+u*O;if(K.Mouse.moveTo(X,Y),E===1)break;await(0,K.sleep)(q)}a()}),getPosition:e,onMove:s=>K.Mouse.onMove(i=>s({x:i.x,y:i.y},i.modifierKeys,i))}})();var re=({when:e,then:t})=>e.onToggleEnabled(()=>{t.hold()},{onDisable:()=>{t.release()}}),Ee=T(re,{getDoc:e=>d.holdKey(e)});var ne=({when:e,then:t})=>e.onDown(()=>t.tap()),Oe=T(ne,{getDoc:e=>d.tapKey(e)});var V=({initial:e=!1,key:t})=>{let o=b(e);return t.onDown(()=>o.toggle()),o};var se=({when:e,then:t,delayMs:o=50})=>e.onToggleEnabled(()=>t.tick({delayMs:o}),{onDisable:()=>t.releaseTick()}),We=T(se,{getDoc:e=>d.tickKey(e)}),Ce=T(({when:e,then:t,activate:o})=>{let r=V({key:o});return I([h(r.listen(n=>{n||t.releaseTick()})),e.onHold(()=>{r.isEnabled&&t.tick()},{onDisable:()=>t.releaseTick()})])},{getDoc:({when:e,then:t,activate:o})=>[`When ${d.tap(o)}, then activate script`,"",`When ${d.hold(e)}, then ${d.hold(t)}`]});var ke=100,Ae=async({needContinue:e,execute:t,delayMs:o=ke})=>{let r=1;for(;e(r);)t(),await(0,g.sleep)(o),r++},Be=async({needContinue:e,execute:t,delayMs:o=ke})=>{let r=1;for(;e(r);)await t(),await(0,g.sleep)(o),r++};0&&(module.exports={BoolState,BoolStateCompose,Cast,Cursor,DisposeWrapper,DocUtils,EasingFunctions,Key,KeysSequence,MouseKey,Observable,PromiseUtils,Queue,Rx,ScrollDirection,ScrollKey,StringUtils,SuchKey,SuchMouseKey,combineDisposers,combineListeners,combineScriptsWithDoc,createTimer,createTimerSequence,force,getHoldKey,getTapKey,getTickByHold,getTickKey,holdKey,inOfAny,runScript,runScripts,sleep,stream,tapKey,tickKey,toDisposer,toListener,toggleStateByTap,whileNeed,whileNeedAsync,wrapToScriptWithDoc});
